# Учебный проект: Telegram-бот для получения списка участников чата на основе истории сообщений без доступа к встроенному списку участников Telegram.

Бот принимает файлы экспорта истории чатов, извлекает уникальных пользователей, которые писали сообщения, и формирует результат в виде списка или Excel-файла.

---

## Описание решения

Бот работает с файлами экспорта истории чатов Telegram (JSON или HTML), анализирует сообщения и определяет всех уникальных авторов сообщений.

Упоминания пользователей в тексте сообщений (`@username`) извлекаются отдельно и не включаются в основной список участников.

В зависимости от количества найденных участников бот:
- отправляет список прямо в чат (если участников меньше 50);
- формирует и отправляет Excel-файл (если участников 50 и более).

Обработка файлов выполняется «на лету» без сохранения пользовательских данных на сервере.

---

## Основные возможности

- Приём файлов экспорта истории чатов Telegram (JSON, HTML)
- Ограничение: не более 10 файлов за одну обработку
- Извлечение уникальных пользователей, которые писали сообщения
- Исключение дублей пользователей
- Исключение удалённых аккаунтов (по данным экспорта)
- Отдельный подсчёт упоминаний `@username`
- Формирование результата:
  - `< 50` участников — список в чате
  - `≥ 50` участников — Excel-файл
- Корректная обработка кодировки UTF-8
- Отсутствие хранения пользовательских данных

---

## Структура Excel-файла

Excel-файл `users.xlsx` содержит следующие поля:

- `export_date` — дата экспорта истории чата
- `username` — username пользователя (если доступен)
- `first_name` — имя пользователя
- `last_name` — фамилия пользователя
- `bio` — описание профиля (в минимальной версии заполняется значением `N/A`)

---

## Используемые технологии

- Python 3.10+
- python-telegram-bot
- openpyxl
- beautifulsoup4
- lxml

---

## Установка и запуск

### 1. Клонирование репозитория
```bash
git clone <ссылка-на-репозиторий>
cd telegram-chat-bot
```
### 2. Создание и активация виртуального окружения

**Windows**
```powershell
py -3.10 -m venv .venv
.\.venv\Scripts\Activate.ps1
```
macOS / Linux

```python3 -m venv .venv
source .venv/bin/activate
```
### 3. Установка зависимостей
```py -3.10 -m pip install -r requirements.txt ```

###4 файле bot.py необходимо указать токен Telegram-бота, полученный через @BotFather:
BOT_TOKEN = "YOUR_TELEGRAM_BOT_TOKEN"

### 5. Запуск бота
py -3.10 bot.py
После запуска бот будет ожидать сообщения в Telegram.

### Использование бота
Открыть чат с ботом в Telegram
Отправить команду /start
Загрузить файлы экспорта истории чата (.json или .html)
После загрузки всех файлов отправить команду /done
Получить результат:

список участников в чате (если участников менее 50), либо

Excel-файл со списком участников (если участников 50 и более)

### Дополнительные команды
/reset — очистить список загруженных файлов

### Формат входных данных
Бот рассчитан на обработку стандартных файлов экспорта истории чатов Telegram, полученных через Telegram Desktop.

## Поддерживаемые форматы:

JSON
HTML

## Конфиденциальность и безопасность
Файлы истории чатов не сохраняются на диск
Обработка данных выполняется в оперативной памяти
После завершения обработки данные удаляются
Бот не передаёт пользовательские данные третьим лицам



